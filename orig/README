# Download modern human genomes from Altai website
wget -r --no-parent -A "SS*.hg19_1000g.*.mod.vcf.*" \
http://cdna.eva.mpg.de/neandertal/altai/ModernHumans/vcf/

# The .vcf files have two problems:
# Problem 1: The "LowQual" value, which shows up in the FILTER
# field, is not defined.
#
# Problem 2: Some INFO fields begin with ".;", which also generates
# a warning in bcftools.
#
# The code below filters all .vcf.gz files through a sed script, which adds 
# a definition of LowQual and replaces the string "\t.;" with "\t". In other 
# words, it deletes ".;" at the beginning of a field.
ls AltaiNea.hg*.vcf.gz | xargs -P 20 -n 1 bash doaltai.sh

# Getting error from bcftools, which reads:
	[W::vcf_parse] INFO '.' is not defined in the header, assuming Type=String
# To find the cause of this error, I looked at the output lines surrounding the error:
	bcftools view AltaiNea.hg19_1000g.22.mod-fixed.vcf.gz 2>&1 | grep -C 20 "not defined"
# A few lines after the error, I found this:
	22      18685734        .       C       .       .       .       .;RM;TS=HHHP;TSseq=C,C,C,-;CAnc=C       GT:A:C:G:T:IR   ./.:0,0:0,1:0,0:0,0:0
	22      18685735        .       A       .       .       .       .;RM;TS=HHHP;TSseq=A,A,A,-;CAnc=A       GT:A:C:G:T:IR   ./.:0,1:0,0:0,0:0,0:0
	22      18685736        .       A       .       .       .       .;RM;TS=HHHP;TSseq=A,A,A,-;CAnc=A       GT:A:C:G:T:IR   ./.:0,1:0,0:0,0:0,0:0

# I suppose I could strip these out with something like "zcat foo.vcf.gz | grep
# -v "<TAB>\.;"" (You have to use "^v<tab>" to insert a literal tab.)

# Concatenate Neanderthal autosomes
bcftools concat --file-list autosomes --threads 20 --output-type b --output AltaiNea.bgz

